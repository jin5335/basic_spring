# ch3. 스프링 핵심 원리 이해2 - 객제 지향 원리 적용

## 전체 흐름 정리

1. 새로운 할인 정책 개발
    - **다형성** 덕분에 **새로운 할인 정책 코드를 추가로 개발**하는 것 자체는 문제 없음
2. 새로운 할인 정책 적용*
    - **문제** 발생
    - 새로운 할인 정책을 적용하려고 하니, 클라이언트 코드(**새로운 할인 정책을 사용하는 코드**, 주문 서비스 구현체 - OrderServiceImpl)을 함께 변경
    - i.e 클라이언트가 인터페이스(DiscountPolicy) 뿐만 아니라, 구현체(FixDiscountPolicy)도 함께 의존 -> **DIP 위반**
3. 관심사의 분리
    - 클라이언트가 로직을 실행하는 역할뿐 아니라, **구현체도 직접 선택해서 생성**
    - 구현체를 생성하고, 이를 클라이언트에 연결하는 역할을 하는 **AppConfig**를 생성
      (i.e AppConfig가 Application 전체를 구성)
    - 클라이언트 객체는 자신의 역할을 수행하는데만 집중 (SRP, 단일 책임의 원치)
4. AppConfig 리팩토링
    - AppConfig 구현에서 중복을 제거하고, 역할과 구현을 더 명확하게 분리
5. 새로운 구조와 할인 정책 적용
    - **AppConfig**를 사용하여,
      Application을 크게 **사용 영역(클라이언트 객체)**와 객체를 생성 및 연결하는 **구성 영역(Configuration)**으로 분리

## 좋은 객체 지향 설계의 5가지 원칙 적용

1. SRP(단일 책임 원칙)
**한 클래스는 하나의 책임만 갖는다.**
2. DIP(의존관계 역전 원칙)
**구체화(구현체?)가 아닌 추상화에 의존해야 한다.** **의존성 주입(DI, Dependency Injection)**은 이 원칙을 수행하는 방법 중 하나.
3. OCP
**소프트웨어 요소는 확장에는 열려 잇으나 변경에는 닫혀있어야 한다.**
    - Application을 사용 영역과 구성 영역으로 분리함으로서,
      새롭게 기능을 추가(확장)해도 사용 영역에 대한 변경은 닫혀 있다.

## IoC(Inversion of Control), DI(Dependency Injection), 그리고 컨테이너

1. IoC(Inversion of Control, 제어의 역전): 프로그램 흐름을 직접 제어하는 것이 아닌, 외부에서 관리하는 것
    - Framework(프레임워크) vs Library(라이브러리)
      - Framework는 내가 작성한 코드를 제어하고, 대신 실행한다 (ex. JUnit)
      - Library는 내가 작성한 코드가 **제어 흐름을 직접 담당**한다.
2. DI(Dependency Injection, 의존관계 주입): 실행 시점에 외부에서 실제 구현 객체를 생성하고, 클라이언트 객체에 전달해서 클라이언트 객체와 서버의 실제 의존관계가 연결 되는 것
    - 의존관계는 **정적인 클래스 의존관계**와 **실행시점(runtime)에 결정되는 동적인 객체(인스턴스) 의존 관계**로 분리해서 생각해야 한다.
    - 정적인 클래스 의존관계
        - 클래스가 사용하는 **import** 구문을 통해 쉽게 판단 가능
        - 클래스 다이어그램
  
    <img src="images/section3_class_diagram.png" alt="클래스 다이어그램" height="400px"/>

    - 동적인 객체 인스턴스 의존관계
        - Application 실행 시점(runtime)에 실제 생성된 객체 인스턴스의 참조(reference, 주소값)이 연결된 의존관계.
        - 객체 다이어그램

  <img src="images/section3_instance_diagram.png" alt="객체 다이어그램" height="250px" />

3. IoC 컨테이너 & DI 컨테이너: **AppConfig 처럼 객체를 생성하고 관리하면서 의존관계를 연결해주는 것**
    - IoC컨테이너와 DI 컨테이너는 동일한 개념인데,
      최근에는 의존관계 주입에 초점을 맞추는 경우 DI 컨테이너라고 한다.
    - 어샘블러, 오브젝트 팩토리 등으로 불리기도 한다.

